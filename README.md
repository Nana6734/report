# report

```

&НаСервере
Процедура СформироватьОтчетНаСервере(ОбластьВыводаОтчета, Дни, ВидДокуммента)
	МассивДней=СтрРазделить(Отчет.Дни, ", ", Ложь); 
	ДеньПервый=МассивДней[0]; 
	ДеньПоследний=МассивДней[МассивДней.ВГраница()];  
	НомерСтроки=1; 
	//{{КОНСТРУКТОР_ЗАПРОСА_С_ОБРАБОТКОЙ_РЕЗУЛЬТАТА
	// Данный фрагмент построен конструктором.
	// При повторном использовании конструктора, внесенные вручную изменения будут утеряны!!!
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ГостеваяКнигаРегистрацияГостей.Ссылка КАК Ссылка,
	|	ГостеваяКнигаРегистрацияГостей.ИмяГостя КАК ИмяГостя,
	|	ГостеваяКнигаРегистрацияГостей.ДеньПриезда КАК ДеньПриезда,
	|	ГостеваяКнигаРегистрацияГостей.ДеньОтъезда КАК ДеньОтъезда
	|ИЗ
	|	Документ.ГостеваяКнига.РегистрацияГостей КАК ГостеваяКнигаРегистрацияГостей
	|ГДЕ
	|	ГостеваяКнигаРегистрацияГостей.Ссылка = &Ссылка";
	
	Запрос.УстановитьПараметр("Ссылка", Отчет.ВидДокумента.Ссылка);
	
	РезультатЗапроса = Запрос.Выполнить();
	ОбластьВыводаОтчета.Очистить();
	
	ОтчетОбъект = РеквизитФормыВЗначение("Отчет");	
	Макет	= ОтчетОбъект.ПолучитьМакет("МакетОтчета");
	ОбластьЗаголовка = Макет.ПолучитьОбласть("Шапка");  
	ОбластьШапки = Макет.ПолучитьОбласть("ШапкаТаблицы");  
	
	
	ОбластьВыводаОтчета.Вывести(ОбластьЗаголовка); 
	ОбластьВыводаОтчета.Вывести(ОбластьШапки);
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выгрузить();
	
	МассивДат=Новый Массив();
	
	Для каждого Дня  Из МассивДней Цикл
		ОбластьСодержимого = Макет.ПолучитьОбласть("Содержимое");  
		ОбластьСодержимого.Параметры.Номер=	НомерСтроки;  
		НомерСтроки=НомерСтроки+1; 
		МассивИмен=Новый Массив;
		Для каждого Строка из ВыборкаДетальныеЗаписи цикл  
			если Не ЗначениеЗаполнено(Строка.ДеньОтъезда) тогда
					Строка.ДеньОтъезда=Число(ДеньПоследний);
			КонецЕсли;

			Если Макс(Строка.ДеньПриезда,Число(ДеньПервый))<=Мин(Строка.ДеньОтъезда, Число(ДеньПоследний)) Тогда  
							Если  Строка.ДеньПриезда<=Число(Дня) и Строка.ДеньОтъезда>=Число(Дня) тогда
					МассивИмен.Добавить(Строка.ИмяГостя);
				КонецЕсли;
			КонецЕсли;
		КонецЦикла;
		
		
		Для каждого Человека Из МассивИмен Цикл
			
			ОбластьСодержимого.Параметры.Количество=Число(МассивИмен.Количество());
			
			
		КонецЦикла;	
		    МассивИмен.Очистить();
		
		ОбластьСодержимого.Параметры.День=Дня;
		
		ОбластьВыводаОтчета.Вывести(ОбластьСодержимого); 
		
		
	КонецЦикла;
	
	//}}КОНСТРУКТОР_ЗАПРОСА_С_ОБРАБОТКОЙ_РЕЗУЛЬТАТА
	
	
	
КонецПроцедуры

&НаКлиенте
Процедура СформироватьОтчет(Команда)
	Если ЗначениеЗаполнено(Отчет.ВидДокумента) и ЗначениеЗаполнено(Отчет.Дни) Тогда
		СформироватьОтчетНаСервере(Отчет.ОбластьВыводаОтчета, Отчет.Дни, Отчет.ВидДокумента);
	иначе
		Сообщить("Вы не заполнили поля ввода");
	КонецЕсли;
КонецПроцедуры
```
